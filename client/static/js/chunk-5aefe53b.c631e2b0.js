(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5aefe53b"],{"09fd":function(t,e,r){"use strict";r("97b5")},"432a":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"banner-container-wrapper"},[r("div",{staticClass:"banner-container"},[r("el-form",{staticClass:"form-search",staticStyle:{width:"100%"},attrs:{inline:!0,size:"mini"}},[r("el-form-item",{staticClass:"btn-form-item"},[r("el-button",{attrs:{icon:"el-icon-circle-plus-outline"},on:{click:t.onAdd}},[t._v("新增")])],1)],1)],1),r("div",{staticClass:"banner-container"},[r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],ref:"dragTable",staticStyle:{width:"100%"},attrs:{data:t.list,"row-key":"id",fit:"","highlight-current-row":""}},[r("el-table-column",{attrs:{property:"id",label:"# (拖拽排序)","min-width":"100",align:"center"}}),r("el-table-column",{attrs:{property:"sort",label:"封面图","min-width":"120",align:"center"},scopedSlots:t._u([{key:"default",fn:function(t){var e=t.row;return[r("img",{staticStyle:{width:"135px",height:"70px"},attrs:{src:e.cover,alt:"封面图"}})]}}])}),r("el-table-column",{attrs:{property:"title",label:"标题","min-width":"100",align:"center"}}),r("el-table-column",{attrs:{property:"url",label:"跳转URL","min-width":"120",align:"center"}}),r("el-table-column",{attrs:{property:"remark",label:"备注","min-width":"130",align:"center"}}),r("el-table-column",{attrs:{label:"操作",align:"center","min-width":"150"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[r("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.handlerEdit(a)}}},[t._v("编辑")]),r("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.handlerDel(a.id)}}},[t._v("删除 ")])]}}])})],1)],1),r("banner-edit",{attrs:{dialogFormVisible:t.dialogFormVisible,title:t.title,bannerItem:t.bannerItem,isAdd:t.isAdd},on:{"update:dialogFormVisible":function(e){t.dialogFormVisible=e},"update:dialog-form-visible":function(e){t.dialogFormVisible=e},"update:isAdd":function(e){t.isAdd=e},"update:is-add":function(e){t.isAdd=e},refreshList:t.fetchListData}})],1)},i=[],n=r("1da1"),s=(r("a434"),r("96cf"),r("aa47")),o=r("b775");function l(){return Object(o["a"])({url:"/banner",method:"get"})}function c(t){return Object(o["a"])({url:"/banner/modify",method:"patch",data:t})}function u(t){return Object(o["a"])({url:"/banner/".concat(t),method:"delete"})}var d=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"container-edit"},[r("el-dialog",{attrs:{title:t.title,visible:t.isVisible,"custom-class":"dialog-container"},on:{"update:visible":function(e){t.isVisible=e}}},[r("el-form",{ref:"ruleForm",attrs:{model:t.formData,rules:t.rules,"label-position":"right",size:"small"}},[r("el-form-item",{attrs:{label:"标题：",prop:"title","label-width":t.formLabelWidth}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:t.formData.title,callback:function(e){t.$set(t.formData,"title","string"===typeof e?e.trim():e)},expression:"formData.title"}})],1),r("el-form-item",{attrs:{label:"图片：",prop:"cover","label-width":t.formLabelWidth}},[r("el-upload",{staticClass:"avatar-uploader",attrs:{action:"#","show-file-list":!1,"auto-upload":!1,"on-change":t.onChange}},[t.formData.cover?r("img",{staticClass:"avatar",attrs:{src:t.formData.cover}}):r("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),r("el-form-item",{attrs:{label:"跳转URL：",prop:"url","label-width":t.formLabelWidth}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:t.formData.url,callback:function(e){t.$set(t.formData,"url","string"===typeof e?e.trim():e)},expression:"formData.url"}})],1),r("el-form-item",{attrs:{label:"备注：",prop:"remark","label-width":t.formLabelWidth}},[r("el-input",{attrs:{type:"textarea"},model:{value:t.formData.remark,callback:function(e){t.$set(t.formData,"remark","string"===typeof e?e.trim():e)},expression:"formData.remark"}})],1)],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(e){t.isVisible=!1}}},[t._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitForm("ruleForm")}}},[t._v("确 定")])],1)],1)],1)},f=[],m=(r("d3b7"),r("3ca3"),r("ddb0"),r("2b3d"),r("9861"),r("c7d5")),b={title:"",cover:"",url:"",remark:""},p={name:"BannerEdit",props:{dialogFormVisible:{type:Boolean,default:!1},title:{type:String,required:!0},bannerItem:{type:Object},isAdd:{type:Boolean,required:!0}},watch:{dialogFormVisible:{handler:function(t){t&&!this.isAdd?this.formData=Object(m["a"])(this.bannerItem):Object.assign(this.formData,b)}}},data:function(){return{imageUrl:"",formLabelWidth:"100px",formData:Object.assign({},b),rules:{title:[{required:!0,message:"请输入标题名称",trigger:"blur"},{min:1,max:30,message:"长度在 1 到 30 个字符",trigger:"blur"}],cover:[{required:!0,message:"请上传轮播图片",trigger:"blur"}],url:[{required:!0,message:"请输入URL路径",trigger:"blur"}],sort:[{required:!0,message:"请选择该分类的排序",trigger:"change"}],remark:[{type:"string",message:"备注不能为空",trigger:"blur"}]}}},computed:{isVisible:{get:function(){return this.dialogFormVisible},set:function(t){this.$emit("update:dialogFormVisible",t),this.$emit("update:isAdd",!1)}}},methods:{submitForm:function(t){var e=this;this.$refs[t].validate((function(t){if(!t)return e.$message.error("保存失败，请重新提交！"),!1;e.$confirm("确定当前所提交的内容吗, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(r){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.isAdd){t.next=6;break}return t.next=3,addCategory(e.formData);case 3:e.$message.success("添加成功！"),t.next=9;break;case 6:return t.next=8,c(e.formData);case 8:e.$message.success("修改成功");case 9:e.isVisible=!1,e.$emit("refreshList");case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(){e.$message({type:"info",message:"已取消提交"})}))}))},onChange:function(t){var e=t.size/1024/1024<2;if(e){var r=window.URL.createObjectURL(t.raw);this.formData.cover=r}else this.$message.error("上传头像图片大小不能超过 2MB!")}}},g=p,h=(r("6507"),r("c439"),r("2877")),v=Object(h["a"])(g,d,f,!1,null,"4cf036b0",null),w=v.exports,y={name:"DragTable",components:{BannerEdit:w},data:function(){return{list:[],total:0,listLoading:!0,listQuery:{page:1,limit:10},sortable:null,dialogFormVisible:!1,bannerItem:{},title:"",isAdd:!1}},created:function(){this.fetchListData()},methods:{fetchListData:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l();case 3:r=e.sent,a=r.data,t.list=a.records,t.total=a.total,e.next=11;break;case 9:e.prev=9,e.t0=e["catch"](0);case 11:t.listLoading=!1,t.$nextTick((function(){t.setSort()}));case 13:case"end":return e.stop()}}),e,null,[[0,9]])})))()},setSort:function(){var t=this,e=this.$refs.dragTable.$el.querySelectorAll(".el-table__body-wrapper > table > tbody")[0];this.sortable=s["a"].create(e,{ghostClass:"sortable-ghost",onEnd:function(e){var r=t.list.splice(e.oldIndex,1)[0];t.list.splice(e.newIndex,0,r),console.log(t.list)}})},handlerEdit:function(t){this.bannerItem=t,this.title="编辑轮播图",this.dialogFormVisible=!0},handlerDel:function(t){var e=this;this.$confirm("此操作将永久删除该分类, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(n["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,u(t);case 2:e.$message({type:"success",message:"删除成功!"}),e.fetchListData();case 4:case"end":return r.stop()}}),r)})))).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},onAdd:function(){this.title="新增轮播图",this.isAdd=!0,this.dialogFormVisible=!0}}},x=y,k=(r("09fd"),r("f4a7"),Object(h["a"])(x,a,i,!1,null,"9268555c",null));e["default"]=k.exports},"460d":function(t,e,r){t.exports={menuText:"#7f7f7f",menuActiveText:"#38ceb1",subMenuActiveText:"#38ceb1",menuBg:"#fff",menuHover:"#ecf8f3",subMenuBg:"#f1f1f1",subMenuHover:"#ecf8f3",sideBarWidth:"210px"}},"51ba":function(t,e,r){},6507:function(t,e,r){"use strict";r("460d")},"97b5":function(t,e,r){},a837:function(t,e,r){},c439:function(t,e,r){"use strict";r("a837")},c7d5:function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));var a=r("53ca"),i=r("3835");r("4fad");function n(t){for(var e=t instanceof Array?[]:{},r=0,s=Object.entries(t);r<s.length;r++){var o=Object(i["a"])(s[r],2),l=o[0],c=o[1];e[l]="object"===Object(a["a"])(c)?n(c):c}return e}},f4a7:function(t,e,r){"use strict";r("51ba")}}]);